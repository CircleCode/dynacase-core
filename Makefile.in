# ============================================
# $id: Makefile.in,v 1.14 2002/01/04 16:04:35 eric Exp $
# ============================================
PACKAGE = @PACKAGE@
VERSION = @VERSION@
utildir=@PUBRULE@
appname = @APPNAME@
pubdir = @prefix@
srcdir = @srcdir@
rootprefix=$(RPM_BUILD_ROOT)


export pubdir utildir appname pidir

TAR = gtar
GZIP_ENV = --best



export targetdir
export utildir

SUBDIR= programs Admin Expire Class Action Zone Share App Api Images Style Doc debian

TOP_MODULES =  indexq.php wsh.php wvirtual.php  guest.php apache.conf  whattext wcheck wstop wstart wdbcreate winitrc apachev.conf.in apachevi.conf.in httpd.pam.in httpdwa.pam.in resizeimg.php libutil.sh wcontrol wcontrol.xml .htaccess index.php

pages_not_xml = info.xml

include $(utildir)/PubRule

DISTFILES += $(SUBDIR)  \
             ChangeLog  VERSION RELEASE WHAT.cron \
	     whattext wcheck wstop wstart wdbcreate winitrc httpd.pam.in httpdwa.pam.in guest.php index.php indexq.php dbaccess.php.sample.in dbaccess.php.in libutil.sh wcontrol wcontrol.xml htaccess



$(pubdir)/indexq.php: indexq.php
	cp $< $@
$(pubdir)/index.php: index.php
	cp $< $@
$(pubdir)/whattext: whattext
	cp $< $@
$(pubdir)/wcheck: wcheck
	cp $< $@
$(pubdir)/wdbcreate: wdbcreate
	cp $< $@
$(pubdir)/winitrc: winitrc
	cp $< $@
$(pubdir)/wstop: wstop
	cp $< $@
$(pubdir)/wstart: wstart
	cp $< $@
$(pubdir)/httpd.pam.in: httpd.pam.in
	cp $< $@
$(pubdir)/httpdwa.pam.in: httpdwa.pam.in
	cp $< $@
$(pubdir)/apachev.conf.in: apachev.conf.in
	cp $< $@
$(pubdir)/apachevi.conf.in: apachevi.conf.in
	cp $< $@
$(pubdir)/libutil.sh: libutil.sh
	cp $< $@
$(pubdir)/wcontrol: wcontrol
	cp $< $@
$(pubdir)/wcontrol.xml: wcontrol.xml
	cp $< $@
$(pubdir)/.htaccess: htaccess
	cp $< $@


$(pubdir)/admin:
	mkdir -p $@
$(rootprefix)/etc/pam.d:
	mkdir -p $@
$(rootprefix)/etc/pam.d/httpd.freedom.sample: $(rootprefix)/etc/pam.d
	cp httpd.pam $@
$(rootprefix)/etc/pam.d/httpdwa.freedom.sample: $(rootprefix)/etc/pam.d
	cp httpdwa.pam $@

$(rootprefix)/etc/cron.daily:
	mkdir -p $@

$(rootprefix)/etc/cron.daily/freedomcore: WHAT.cron $(rootprefix)/etc/cron.daily
	cp WHAT.cron $@
	chmod 644 $@

$(pubdir)/FDLGEN:
	mkdir -p $@
$(pubdir)/FDLGEN/default: $(pubdir)/FDLGEN
	ln -sf ../context/default/FDLGEN $@
$(pubdir)/context/default/FDLGEN:
	mkdir -p $@
$(pubdir)/context/default/dbaccess.php.sample: dbaccess.php.sample $(pubdir)/context/default/FDLGEN $(pubdir)/FDLGEN/default
	cp $< $@
$(pubdir)/context/default/dbaccess.php.in: dbaccess.php.in
	cp $< $@

$(pubdir)/session:
	mkdir -p $@
$(pubdir)/session/.htaccess: htaccess.session $(pubdir)/session
	cp $< $@

$(pubdir)/img-cache:
	mkdir -p $@
$(pubdir)/img-cache/.htaccess: htaccess.img-cache $(pubdir)/img-cache
	cp $< $@

publish:   $(pubdir)/context/default/dbaccess.php.sample $(pubdir)/context/default/dbaccess.php.in $(pubdir)/session/.htaccess $(pubdir)/img-cache/.htaccess

clean:
	rm -f *.*~ config.* Makefile configure $(PACKAGE).spec \
	      $(PACKAGE)-Fedora.spec $(PACKAGE)-$(VERSION).tar.gz \
	      dbaccess.php.sample apache.conf App/Core/CORE_init.php \
	      App/Users/USERS_init.php App/Access/ACCESS_init.php \
	      App/Authent/AUTHENT_init.php App/Appmng/APPMNG_init.php \
	      httpd.pam \
	      Api/updateclass.php
